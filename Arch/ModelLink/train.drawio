<mxfile host="Electron" modified="2024-05-07T08:23:26.619Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/24.2.5 Chrome/120.0.6099.109 Electron/28.1.0 Safari/537.36" etag="P-DBBhE8X-QOA-mRxgVo" version="24.2.5" type="device">
  <diagram name="第 1 页" id="lJStV8RaI5A1z8thdrf8">
    <mxGraphModel dx="2517" dy="1262" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="olY7b1tFrQfHIkuSDPjI-1" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #ce9178;&quot;&gt;pretrain_gpt.py&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="100" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-2" target="olY7b1tFrQfHIkuSDPjI-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-2" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;train_valid_test_datasets_provider&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="230" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-3" target="olY7b1tFrQfHIkuSDPjI-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-3" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;model_provider&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="400" y="230" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-31" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-4" target="olY7b1tFrQfHIkuSDPjI-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-4" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;forward_step&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="740" y="230" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-6" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-1" target="olY7b1tFrQfHIkuSDPjI-2">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="390" y="420" as="sourcePoint" />
            <mxPoint x="440" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-7" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-1" target="olY7b1tFrQfHIkuSDPjI-3">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="418" y="150" as="sourcePoint" />
            <mxPoint x="220" y="240" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-8" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-1" target="olY7b1tFrQfHIkuSDPjI-4">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="428" y="160" as="sourcePoint" />
            <mxPoint x="230" y="250" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-9" target="olY7b1tFrQfHIkuSDPjI-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-9" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;megatron.core.dataset&lt;/div&gt;&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;BlendedMegatronDatasetBuilder&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="340" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-11" target="olY7b1tFrQfHIkuSDPjI-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-11" value="self._build_blended_dataset_splits()" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="105" y="440" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-13" target="olY7b1tFrQfHIkuSDPjI-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-13" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;_build_megatron_dataset_splits&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="525" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-15" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;build_generic_dataset&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="120" y="640" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-17" target="olY7b1tFrQfHIkuSDPjI-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #cccccc;&quot;&gt;megatron.core.models.gpt&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;GPTModel()&lt;/div&gt;" id="olY7b1tFrQfHIkuSDPjI-17">
          <mxCell style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
            <mxGeometry x="355" y="340" width="210" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-19" target="olY7b1tFrQfHIkuSDPjI-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-19" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #4ec9b0;&quot;&gt;LanguageModelEmbedding&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="440" width="180" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-21" target="olY7b1tFrQfHIkuSDPjI-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-21" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #4ec9b0;&quot;&gt;RotaryEmbedding&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="390" y="555" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-26" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-23" target="olY7b1tFrQfHIkuSDPjI-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-23" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #4ec9b0;&quot;&gt;TransformerBlock&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="390" y="690" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-25" target="olY7b1tFrQfHIkuSDPjI-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-25" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #4ec9b0;&quot;&gt;tensor_parallel&lt;/span&gt;.&lt;span style=&quot;color: #4ec9b0;&quot;&gt;ColumnParallelLinear&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="315" y="800" width="290" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-28" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;setup_embeddings_and_output_layer&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="325" y="930" width="270" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-33" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-30" target="olY7b1tFrQfHIkuSDPjI-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-30" value="&lt;div style=&quot;background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;color: rgb(204, 204, 204);&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;get_batch&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font color=&quot;#dcdcaa&quot;&gt;参数为data_provider&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="720" y="350" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-37" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-32" target="olY7b1tFrQfHIkuSDPjI-36">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-32" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #9cdcfe;&quot;&gt;model&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #9cdcfe;&quot;&gt;forward&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="740" y="470" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-34" target="olY7b1tFrQfHIkuSDPjI-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-34" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;rotation=-180;size=0.5;" vertex="1" parent="1">
          <mxGeometry x="595" y="460" width="90" height="500" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-36" value="logits" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="740" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-38" target="olY7b1tFrQfHIkuSDPjI-39">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-38" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;rotation=270;" vertex="1" parent="1">
          <mxGeometry x="452.5" y="752.5" width="65" height="590" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-42" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-39" target="olY7b1tFrQfHIkuSDPjI-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-39" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;megatron.training&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;pretrain()&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="392.5" y="1109" width="185" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-57" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-41" target="olY7b1tFrQfHIkuSDPjI-56">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-41" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;initialize_megatron&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="387.5" y="1230" width="195" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-43" target="olY7b1tFrQfHIkuSDPjI-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-43" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;size=0;rotation=180;" vertex="1" parent="1">
          <mxGeometry x="325" y="1200" width="20" height="230" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-46" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;parse_args&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="200" y="1190" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-47" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;load_args_from_checkpoint&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="115" y="1220" width="230" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-48" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;validate_yaml&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="170" y="1260" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-52" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-49" target="olY7b1tFrQfHIkuSDPjI-50">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-49" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;finish_mpu_init&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="155" y="1300" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-50" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;_initialize_distributed&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-100" y="1300" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-53" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;_init_autoresume&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="155" y="1337.5" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-54" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;_compile_dependencies&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="125" y="1373" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-55" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;_initialize_tp_communicators&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="1410" width="250" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-68" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-56" target="olY7b1tFrQfHIkuSDPjI-67">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-56" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;setup_model_and_optimizer&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="377.5" y="1450" width="215" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-58" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;" vertex="1" parent="1">
          <mxGeometry x="610" y="1420" width="20" height="120" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-66" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-59" target="olY7b1tFrQfHIkuSDPjI-65">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-59" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;get_model&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="1400" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-60" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;unwrap_model&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="1430" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-61" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;get_megatron_optimizer&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="1460" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-63" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;get_optimizer_param_scheduler&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="1490" width="260" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-64" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;load_checkpoint&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="640" y="1520" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-65" value="包含&lt;div&gt;1. 基于provider生成模型&lt;/div&gt;&lt;div&gt;2. params tp attribute&lt;/div&gt;&lt;div&gt;3. toFloat16 or BFloat16&lt;/div&gt;&lt;div&gt;3.&amp;nbsp;&lt;span style=&quot;color: rgb(78, 201, 176); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; white-space: pre;&quot;&gt;DistributedDataParallel&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="760" y="1290" width="240" height="87.5" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-70" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-67" target="olY7b1tFrQfHIkuSDPjI-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-67" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;get_model_config&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="407.5" y="1560" width="155" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-72" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-69" target="olY7b1tFrQfHIkuSDPjI-71">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-69" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;build_train_valid_test_data_iterators&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="328" y="1670" width="315" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-74" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-71" target="olY7b1tFrQfHIkuSDPjI-73">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-71" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;train()&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="425.5" y="1790" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-76" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-73" target="olY7b1tFrQfHIkuSDPjI-75">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-73" value="train_step()" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="225.5" y="1790" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-75" value="&lt;div style=&quot;color: rgb(204, 204, 204); background-color: rgb(31, 31, 31); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;get_forward_backward_func&lt;/span&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="-80" y="1790" width="225.5" height="60" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-77" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;labelPosition=left;verticalLabelPosition=middle;align=right;verticalAlign=middle;rotation=180;" vertex="1" parent="1">
          <mxGeometry x="-150" y="1760" width="20" height="120" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-78" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.1;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="olY7b1tFrQfHIkuSDPjI-75" target="olY7b1tFrQfHIkuSDPjI-77">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-79" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;forward_backward_pipelining_with_interleaving&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-520" y="1760" width="380" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-80" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;forward_backward_pipelining_without_interleaving&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-540" y="1800" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="olY7b1tFrQfHIkuSDPjI-81" value="&lt;div style=&quot;color: #cccccc;background-color: #1f1f1f;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #dcdcaa;&quot;&gt;forward_backward_no_pipelining&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-400" y="1840" width="260" height="40" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
